---
title: "R Notebook"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(forecast)
library(urca)
```

## モデルの同定
1 ARMA次数：モデル選択
2 差分の階数：単位根検定
3 モデル評価

## ARMA次数：モデル選択
### AICでモデル選択

統計モデルを$\{p_{\theta}|\theta \in \Theta\}$とする．
$k$次元部分モデル空間の列を$\Theta_k \subset \Theta (k=1,...,d)$とかくと，
適切な$\Theta_k$を選ぶ問題である．

ここで$\hat{\theta}_k$を$\Theta_k$における最尤推定量，すなわち$n$個のデータ
$\{z_1,...,z_n\}$に対して，

$$
\hat{\theta}_k = \mbox{argmax}_{\theta\in \Theta_k}\sum_{i=1}^n\log(p_{\theta}(z_i))
$$


このとき，モデル$\Theta_k$のAICは
$$
AIC(k) = -2\sum_{i=1}^n\log(p_{\hat{\theta}_k}(z_i))+2k
$$

単純に$\Theta_k$ごとに最大対数尤度を比べると，$\Theta_d$が一番大きくなる．
(小さいモデルは大きいモデルで表現できるため)．正則化として$2k$が加わることで予測の観点でも
”よい”モデルを選択できる．

## 差分をとるか判断する：単位根検定
注：テキストにはAICでは何階差分をとればいいかは分からないと書いてあるが別にAICで選んでもいいと思う．

### KPSS検定とADF検定
どちらも単位根検定．

KPSS test
- $H_0$: 定常過程
- $H_1$: 単位根過程


KPSS test
- $H_0$: 単位根過程
- $H_1$: 単位根過程

